{% extends "base.html" %}
{% load i18n %}
{% load apptags %}

{% block main %}
    <div class="container">

      <h1>{% trans "Addressbook" %}</h1>
      <p>{% trans "Managing contacts and assigning names and numbers" %}.</p>
      <br />

<ul class="nav nav-tabs">
  <li><a href="/addressbook/">{% trans "Personal address book" %}</a></li>
  <li class="active"><a href="/addressbook-global/">{% trans "Global address book" %}</a></li>
</ul>

<form method="post" class="form-horizontal">
{% csrf_token %}

<fieldset>

<!-- Button -->
<div class="control-group">
  <label class="control-label tooltip-hover" for="filter-ads" data-toggle="tooltip" data-placement="left" title="{% trans "If enabled, you can be called from anyone. If disabled, you can still call everyone in the global address book." %}">{% trans "Global availability" %}</label>
  <div class="controls">
{% if global_availability == '1' %}
    <button id="global-availability" name="global-availability" class="btn btn-success" value="1">{% trans "I am globally available" %}</button>
{% else %}
    <button id="global-availability" name="global-availability" class="btn btn-inverse" value="1">{% trans "Disabled" %}</button>
{% endif %}
  </div>
</div>
</fieldset>

{% if form.errors %}
<div class="alert alert-error">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    <strong>{% trans "Error" %}:</strong>
{{ form.errors }}
</div>
{% endif %}

{% if global_availability == '1' %}
    <legend>{% trans "My global hostname and phone number" %}</legend>

    <input {% form_error form.name.errors %} id="name" name="name" type="text" placeholder="{% trans "Hostname" %}" class="input-large" value="{{ form.name.value }}" />
    <input {% form_error form.phone.errors %} id="phone" name="phone" type="text" placeholder="{% trans "Phone number" %}" class="input-mini" value="{{ form.phone.value }}" maxlength="7" />
    <button id="set_address" name="set_address" class="btn btn-primary" value="1">{% trans "Set" %}</button>
{% if global_hostname != None or global_phone != None %}
    <button id="unregister" name="unregister" class="btn btn-danger" value="1">{% trans "Unregister" %}</button>
{% endif %}
    <br /><br />
{% endif %}

</fieldset>
</form>

<legend>{% trans "Global address book" %}</legend>

<table class="table table-hover table-striped table-bordered">
    <thead>
      <tr>
        <th>{% trans "Hostname" %}</th>
        <th>{% trans "IPv6 address" %}</th>
        <th>{% trans "Phone number" %}</th>
      </tr>
    </thead>
    <tbody>
    <tr>
        <td><a href="{% url app.views.addressbook %}">{% trans "My address" %}</a></td>
        <td>{% display_ip %}</td>
        <td>1</td>
    </tr>
    {% for address in addresses %}
    <tr>
        <td><a href="{% url app.views.addressbook_edit address.pk %}">{{ address.name }}</a></td>
        <td>{{ address.ipv6 }}</td>
        <td>{{ address.phone|default_if_none:'-' }}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>

    </div> <!-- /container -->
{% endblock %}
